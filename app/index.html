<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Conductoor</title>
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <!-- build:css styles/main.css -->
    <link rel="stylesheet" href="styles/main.css">
    <!-- endbuild-->
    <!-- build:js bower_components/webcomponentsjs/webcomponents.min.js -->
    <script src="bower_components/webcomponentsjs/webcomponents.js"></script>
    <!-- endbuild -->
    <script src="bower_components/underscore/underscore-min.js"></script>
    <link rel="import" href="../../bower_components/polymer/polymer.html">
    <!-- build:vulcanized elements/elements.vulcanized.html -->
    <link rel="import" href="../elements/elements.html">
    <!-- endbuild-->

    <link rel="import" href="../bower_components/app-router/app-router.html">
  </head>
  <body unresolved fullbleed>
    <core-localstorage id="projectBackup" name="project-backup"></core-localstorage>
    <core-localstorage id="currentProject" name="currentProject"></core-localstorage>
    <core-localstorage id="userSelectionBackup" name="userSelectionBackup"></core-localstorage>
    <core-localstorage id="session" name="session"></core-localstorage>


    <polymer-element name="conductoor-app">
      <template>
        <user-session session="{{session}}"></user-session>

        <app-router on-state-change="{{stateChange}}">
          <!-- Project page -->
          <app-route path="/project/allocate/:projectId" import="/pages/project-page.html"></app-route>

          <!-- Project listing page -->
          <app-route path="/list-projects" import="/pages/project-listing-page.html"></app-route>

          <!-- Create project page -->
          <app-route path="/project/create" import="/pages/create-project-page.html"></app-route>

          <!-- Create project page -->
          <app-route path="/project/edit/:projectId" import="/pages/edit-project-page.html"></app-route>

          <!-- Help page -->
          <app-route path="/help" import="/pages/help-page.html"></app-route>

          <!-- My account page -->
          <app-route path="/my-account" import="/pages/my-account-page.html"></app-route>

          <!-- matches using a wildcard -->
          <app-route path="*" import="/pages/landing-page.html" bindRouter></app-route>

        </app-router>

      </template>
      <script>
        Polymer('conductoor-app', {
          created: function() {
            this.session = document.querySelector("#session");
          },
          stateChange: function(event) {
            // redirect to the login page if not signed in
            // if (!this.session.loggedIn && event.detail.path !== '/') {
            //   console.log("unauthorized");
            //   event.preventDefault();
            //   this.querySelector('::shadow app-router').go('/');
            // }
          }
        });
      </script>
    </polymer-element>

    <conductoor-app></conductoor-app>
    <!-- build:js scripts/app.js -->
    <script src="scripts/app.js"></script>
    <!-- endbuild-->

  </body>
</html>
