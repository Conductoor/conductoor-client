<link rel="import" href="../../bower_components/polymer/polymer.html">


<!-- build:js scripts/timesheet.js -->
<script src="../../scripts/timesheet.js"></script>
<!-- endbuild-->
<polymer-element name="conductoor-timeline" attributes="project">
  <template>
    <link rel="stylesheet" href="conductoor-timeline.css">
    <!-- build:css styles/timesheet.css -->
    <link rel="stylesheet" href="../../styles/timesheet.css">
    <!-- endbuild-->

    <div flex class="timeline-panel">
      <div class="timeline-header">
        <h3 on-click=”{{drawBubble}}”>Project timeline</h3>
      </div>

      <div horizontal layout>
        <div flex id="timeline"></div>
      </div>

    </div>
  </template>
  <script>
    var timesheet;
    Polymer({
      // define element prototype here
      ready: function() {
        document.addEventListener('show-timeline', (function(e) {
            if (this.project.phases) {
              console.log(this.getData(this.project));
              timesheet = new Timesheet(this.$.timeline, new Date(this.project.duration.start),
                new Date(this.project.duration.end), this.getData(this.project));
            }
          }).bind(this));
      },
      getRandomColor: function() {
          var letters = '0123456789ABCDEF'.split('');
          var color = '#';
          for (var i = 0; i < 6; i++ ) {
              color += letters[Math.floor(Math.random() * 16)];
          }
          return color;
      },
      getData: function(project) {
        var data = [];
        for (var i=0; i<project.phases.length; i++) {
          data.push(
            [
              new Date(project.phases[i].duration.start),
              new Date(project.phases[i].duration.end),
              project.phases[i].name,
              '#' + project.phases[i].color
            ]);
        }
        return data;
      },
      drawBubble: function() {
        console.log(timesheet);
        timesheet.insertData();
      }
    });


  </script>
  <script type="text/javascript">
  </script>
</polymer-element>
