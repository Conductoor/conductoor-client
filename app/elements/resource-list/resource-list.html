<link rel="import" href="../../bower_components/polymer/polymer.html">


<polymer-element name="resource-list" attributes="userSelection">
  <template>
    <!-- build:css resource-list.css -->
    <link rel="stylesheet" type="text/css" href="resource-list.css">
    <!-- endbuild-->
    <core-localstorage name="conductoor-project-data" value="{{project}}"></core-localstorage>
    <core-ajax
      id = "getResources"
      auto
      url="http://conductoor-api.herokuapp.com/users/"
      params=''
      handleAs="json"
      on-core-response="{{handleResponse}}"
      core-error="{{handleError}}">
    </core-ajax>

    <core-selector selected="0">
    <template repeat="{{resource in resources}}">
      <paper-item
        title="Select a resource"
        no-padding
        on-click={{selectPerson}}
        class="resource {{ {free: resource.free, reserved: !resource.free} | tokenList}}">
        <span flex>{{resource.first_name}} {{resource.last_name}}</span>
        <template if="{{ !resource.free }}" >
          <core-icon icon="block"></core-icon>
        </template>

      </paper-item>
    </template>
    </core-selector>

  </template>

  <script>
    (function () {
      Polymer( "resource-list", {
        created: function() {
          // TODO
        },
        handleResponse: function(event, res) {
          console.log(res.response);
          this.resources = res.response
          this.userSelection.selectedPerson = this.resources[0];
        },
        handleError: function(event, response) {
          console.log("Error");
          console.log(response);
        },
        selectPerson: function(event, detail, sender) {
          this.userSelection.selectedPerson = sender.templateInstance.model.resource;
        }
      });
    })();
  </script>

</polymer-element>

